# 更新日志 [中文] | [English](changelog.en.md)

## 2025-02-13 JSON配置格式优化
1. 更新promptBlocks存储格式
   - 将promptBlocks从数组格式改为对象格式
   - 新格式使用promptBlock1、promptBlock2等作为键名
   - 保持对旧格式的兼容性，支持读取数组格式
   - 导出时统一使用新格式

2. 代码实现优化
   - 更新useConfig.ts中的配置处理逻辑
   - 优化配置验证机制，支持两种格式检查
   - 改进配置导入导出功能
   - 更新示例配置文件为新格式

3. 向后兼容性保证
   - 保持对现有配置文件的兼容
   - 在导入时自动处理新旧格式转换
   - 确保所有功能正常运行
   - 完善错误处理机制

## 2025-02-12 国际化基础设施完成
1. 完成基础设施搭建
   - 安装并配置vue-i18n
   - 创建语言文件结构
   - 实现语言状态管理composable

2. 完成语言文本管理
   - 实现完整的类型定义
   - 创建中英文翻译文件
   - 实现useLanguage composable
   - 完成组件改造示例

3. 完成数据加载逻辑改造
   - 实现按语言加载不同目录JSON文件
   - 添加语言切换时的数据重新加载
   - 完成文件列表自动生成脚本

4. 待完成项
   - 单元测试
   - 集成测试
   - UI测试
   - 兼容性测试

## 2025-02-12 新增大模型最佳实践文档
1. 新增双语最佳实践文档
   - 创建中文版新增大模型最佳实践指南
   - 创建英文版新增大模型最佳实践指南
   - 在README中添加文档链接
   - 完整的步骤说明和示例代码

2. 文档内容要点
   - API验证流程说明
   - 类型定义和配置指南
   - 前端集成步骤详解
   - 测试验证方法说明
   - 常见问题解决方案

3. 实际案例展示
   - 使用火山DeepseekV3作为示例
   - 完整的实现过程演示
   - 关键配置说明
   - 注意事项和最佳实践


## 2025-02-09 WebSocket架构优化
1. WebSocket连接管理优化
   - 按业务场景分离WebSocket连接管理
   - 测速按钮专用连接池：SpeedTestButtonWebSocket
   - 执行按钮专用连接池：ExecuteButtonWebSocket
   - 统一的连接接口：getConnection(blockIndex, model)

2. 并发控制优化
   - 测速功能：SpeedTestButtonQueue（固定并发数为4）
   - 执行功能：ExecuteButtonQueue（默认并发数为2）
   - 独立的队列管理和错误处理
   - 更可靠的状态同步机制

3. 消息处理优化
   - 统一的消息处理流程
   - 完善的空值检查
   - 更清晰的错误提示
   - 更准确的状态更新

4. 代码结构优化
   - 更清晰的文件命名规范
   - 业务逻辑完全分离
   - 更好的代码复用
   - 更易于维护的架构

## 2025-02-09 历史记录分离功能
1. 历史记录存储优化
   - 实现对话和智能体历史记录分离
   - 通过路由meta配置自动加载对应历史记录
   - 优化历史记录存储结构，支持多页面独立存储
   - 完善历史记录持久化方案

2. 用户体验改进
   - 在页面切换时自动切换对应历史记录
   - 优化历史记录删除操作，自动清理右侧面板
   - 保持最新记录置顶的排序逻辑
   - 添加同步状态和错误提示

3. 技术实现优化
   - 添加路由meta类型定义
   - 实现路由守卫处理页面切换
   - 优化历史记录组件的props传递
   - 完善相关文档说明

## 2025-02-09 WebSocket路径统一配置
1. WebSocket路径标准化
   - 统一前后端WebSocket路径为'/websocket'
   - 修复了开发环境和生产环境的路径不一致问题
   - 更新了nginx配置以正确代理WebSocket请求
   - 确保所有WebSocket客户端使用相同的连接配置

2. 配置优化
   - 统一了WebSocket URL构建逻辑
   - 更新了测速功能的WebSocket连接配置
   - 优化了开发环境的WebSocket服务配置
   - 完善了相关文档说明

## 2025-02-09 测速功能优化
1. 优化测速功能实现
   - 改进后端测速模式的会话管理
   - 使用特定前缀标识测速会话
   - 优化并发请求处理机制
   - 提供更稳定的测试体验

2. 实现细节改进
   - 统一测速会话ID格式：`speed_test_${model}_${Date.now()}`
   - 利用后端请求队列管理并发
   - 优化错误处理机制
   - 添加详细的测速功能文档

3. 文档更新
   - 新增测速功能专门文档
   - 完整的实现架构说明
   - 详细的使用指南
   - 性能优化建议
